(function(a){a.fn.bubble=function(n){var d=a.extend({},a.fn.bubble.defaults,n);var i=a(d.bubble);var f=null;var k=null;var j=false;var h=function(A,v){k=null;if(!j){if(d.onShow){d.onShow(A[0])}var z=a(window);var r=null;var p=0;if(v){r={top:v.pageY,left:v.pageX+10}}else{r=l(A,i);p=A.outerWidth()}var x=z.height()+z.scrollTop();var u=x-i.height()-15;if(r.top>u){var y=u}else{var y=r.top}var s=z.width()+z.scrollLeft();var o=s-i.width()-15;if(r.left+p>o){var q=o}else{var q=g(A,r,p,i)}i.css({top:y,left:q,display:"block"}).show();j=true}};var c=function(o){if(d.onHide){d.onHide(o[0])}f=null;i.hide();j=false};var l=function(o){if(!d.inContainer){return o.offset()}return o.position()};var g=function(r,s,p,o){var q=s.left+p;if(!d.inContainer){return q}if(r.offsetParent().width()<(q+o.width())){return 0}return q};var e=null;if(d.toggleEvent=="hover"){this.unbind("mouseover");this.mouseover(function(p){var o=a(this);if(e){if(this!=e){e=this;c(o)}}else{e=this}if(f){clearTimeout(f)}if(k){return}k=setTimeout(function(){h(o)},d.showDelay);return false});i.unbind("mouseover");i.mouseover(function(){if(f){clearTimeout(f)}f=null;return false});var b=a(this.get()).add(i[0]);b.unbind("mouseout");b.mouseout(function(p){var o=a(this);if(k){clearTimeout(k);k=null}if(f){clearTimeout(f)}f=setTimeout(function(){c(o)},d.hideDelay);return false})}if(d.toggleEvent=="click"){this.unbind("click");this.click(function(p){var o=a(this);i.unbind("click.bubble");i.bind("click.bubble",function(q){q.stopPropagation()});a(window).unbind("click.bubble");a(window).bind("click.bubble",function(q){if(j){c(a(this))}});h(o);return false})}var m=this;this.hide=function(){c(a(m))};this.show=function(o){h(a(m),o)};return this};a.fn.bubble.defaults={offsetX:15,offsetY:0,toggleEvent:"hover",showDelay:500,onShow:null,hideDelay:500,onHide:null,autoHide:true,inContainer:false}})(jQuery);